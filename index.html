<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flappy Bird Clone</title>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        background-color: #71c5cf;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        font-family: Arial, sans-serif;
      }

      canvas {
        display: block;
        border: none;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        background-color: #4ec0ca;
        width: 100%;
        max-width: 400px;
      }

      .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: white;
        font-size: 2em;
        text-align: center;
        pointer-events: none;
        background-color: rgba(0, 0, 0, 0.5);
      }

      .overlay-text {
        margin-bottom: 20px;
        text-shadow: 2px 2px 4px #000000;
      }

      .overlay-button {
        padding: 10px 20px;
        background-color: rgba(255, 255, 255, 0.3);
        border: 2px solid white;
        border-radius: 5px;
        cursor: pointer;
        pointer-events: auto;
        font-size: 0.8em;
        text-shadow: 2px 2px 4px #000000;
      }

      .score-display {
        position: absolute;
        top: 10px;
        left: 10px;
        color: white;
        font-size: 1.5em;
        text-shadow: 2px 2px 4px #000000;
      }

      .high-score-display {
        position: absolute;
        top: 10px;
        right: 10px;
        color: rgba(255, 255, 255, 0.8);
        font-size: 1em;
        text-shadow: 1px 1px 2px #000000;
        text-align: right;
      }

      .collected-letters-display {
        position: absolute;
        bottom: 10px;
        left: 10px;
        color: white;
        font-size: 1em;
        text-shadow: 1px 1px 2px #000000;
      }
    </style>
  </head>
  <body>
    <canvas id="gameCanvas" width="400" height="600"></canvas>
    <div id="overlay" class="overlay"></div>
    <div id="scoreDisplay" class="score-display">Score: 0</div>
    <div id="highScoreDisplay" class="high-score-display">High Score: 0</div>
    <div id="collectedLettersDisplay" class="collected-letters-display">Letters:</div>

    <audio id="flapSound" src="flap.wav" preload="auto"></audio>
    <audio id="scoreSound" src="score.wav" preload="auto"></audio>
    <audio id="collisionSound" src="collision.wav" preload="auto"></audio>
    <audio id="letterSound" src="letter.wav" preload="auto"></audio>

    <script>
      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d");
      const overlay = document.getElementById("overlay");
      const scoreDisplay = document.getElementById("scoreDisplay");
      const highScoreDisplay = document.getElementById("highScoreDisplay");
      const collectedLettersDisplay = document.getElementById("collectedLettersDisplay");

      const flapSound = document.getElementById("flapSound");
      const scoreSound = document.getElementById("scoreSound");
      const collisionSound = document.getElementById("collisionSound");
      const letterSound = document.getElementById("letterSound");

      const birdEmoji = "üê¶";
      const availableLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      const wordsToCollect = ["APPLE", "HOUSE", "TRAIN", "CLOUD", "RIVER"];
      let currentWordIndex = 0;
      let currentWord = wordsToCollect[currentWordIndex];
      let collectedWordLetters = [];

      class Bird {
        constructor() {
          this.x = 80;
          this.y = 200;
          this.size = 25;
          this.velocityY = 0;
          this.gravity = 0.6;
          this.jumpStrength = -12;
        }

        draw() {
          ctx.font = `${this.size}px serif`;
          ctx.fillStyle = "white";
          ctx.shadowColor = "black";
          ctx.shadowOffsetX = 2;
          ctx.shadowOffsetY = 2;
          ctx.shadowBlur = 3;
          ctx.fillText(birdEmoji, this.x - this.size / 2, this.y + this.size / 2 - 5);
          ctx.shadowColor = "transparent";
        }

        update() {
          this.velocityY += this.gravity;
          this.y += this.velocityY;
        }

        jump() {
          this.velocityY = this.jumpStrength;
          playSound(flapSound);
        }
      }

      class Pipe {
        constructor(x, letter) {
          this.x = x;
          this.width = 60;
          this.gap = 160;
          this.speed = 2.5;
          this.minHeight = 50;
          this.maxHeight = canvas.height / 2;
          this.topPipeHeight =
            Math.random() * (this.maxHeight - this.minHeight) + this.minHeight;
          this.bottomPipeY = this.topPipeHeight + this.gap;
          this.letter = letter;
          this.collected = false;
        }

        draw() {
          const pipeGradient = ctx.createLinearGradient(this.x, 0, this.x + this.width, 0);
          pipeGradient.addColorStop(0, "#32CD32");
          pipeGradient.addColorStop(1, "#228B22");
          ctx.fillStyle = pipeGradient;
          ctx.fillRect(this.x, 0, this.width, this.topPipeHeight);
          ctx.fillRect(this.x, this.bottomPipeY, this.width, canvas.height - this.bottomPipeY);
          ctx.fillStyle = "#228B22";
          ctx.fillRect(this.x - 5, this.topPipeHeight - 20, this.width + 10, 20);
          ctx.fillRect(this.x - 5, this.bottomPipeY, this.width + 10, 20);
          if (!this.collected) {
            ctx.fillStyle = "white";
            ctx.font = "24px Arial";
            ctx.textAlign = "center";
            ctx.fillText(this.letter, this.x + this.width / 2, this.topPipeHeight + this.gap / 2 + 8);
            ctx.textAlign = "start";
          }
        }

        update() {
          this.x -= this.speed;
        }
      }

      const game = {
        bird: new Bird(),
        pipes: [],
        pipeSpacing: 220,
        score: 0,
        gameStarted: false,
        gameOver: false,
        highScore: localStorage.getItem("highScore") || 0,
        collectedLetters: [],
        wordLettersNeeded: [],

        resetGame() {
          this.bird = new Bird();
          this.pipes = [];
          this.score = 0;
          this.gameStarted = false;
          this.gameOver = false;
          this.collectedLetters = [];
          currentWordIndex = 0;
          currentWord = wordsToCollect[currentWordIndex];
          collectedWordLetters = [];
          this.wordLettersNeeded = [...currentWord];
          this.generateWordPipes();
          hideOverlay();
          this.updateScoreDisplay();
          this.updateHighScoreDisplay();
          this.updateCollectedLettersDisplay();
        },

        generateWordPipes() {
          this.pipes = [];
          let currentX = canvas.width;
          for (let i = 0; i < currentWord.length; i++) {
            this.pipes.push(new Pipe(currentX, currentWord[i]));
            currentX += this.pipeSpacing * 2;
          }
          for (let i = 0; i < 5; i++) {
            this.pipes.push(
              new Pipe(
                currentX,
                availableLetters.charAt(Math.floor(Math.random() * availableLetters.length))
              )
            );
            currentX += this.pipeSpacing;
          }
        },

        updateScoreDisplay() {
          scoreDisplay.textContent = `Score: ${this.score}`;
        },

        updateHighScoreDisplay() {
          highScoreDisplay.textContent = `High Score: ${this.highScore}`;
        },

        updateCollectedLettersDisplay() {
          collectedLettersDisplay.textContent = `Word: ${collectedWordLetters.join(
            ""
          )} - Find: ${currentWord}`;
        },

        drawBackground() {
          const skyGradient = ctx.createLinearGradient(0, 0, 0, canvas.height - 100);
          skyGradient.addColorStop(0, "#71c5cf");
          skyGradient.addColorStop(1, "#a0d6e4");
          ctx.fillStyle = skyGradient;
          ctx.fillRect(0, 0, canvas.width, canvas.height - 100);
          const groundGradient = ctx.createLinearGradient(0, canvas.height - 100, 0, canvas.height);
          groundGradient.addColorStop(0, "#daa520");
          groundGradient.addColorStop(1, "#b8860b");
          ctx.fillStyle = groundGradient;
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = "white";
          ctx.globalAlpha = 0.7;
          ctx.beginPath();
          ctx.arc(50, 70, 30, 0, Math.PI * 2);
          ctx.arc(90, 70, 20, 0, Math.PI * 2);
          ctx.arc(70, 50, 25, 0, Math.PI * 2);
          ctx.closePath();
          ctx.fill();
          ctx.beginPath();
          ctx.arc(200, 120, 40, 0, Math.PI * 2);
          ctx.arc(250, 120, 30, 0, Math.PI * 2);
          ctx.arc(220, 90, 35, 0, Math.PI * 2);
          ctx.closePath();
          ctx.fill();
          ctx.globalAlpha = 1;
        },

        drawPipes() {
          for (let i = 0; i < this.pipes.length; i++) {
            this.pipes[i].draw();
          }
        },

        updatePipes() {
          for (let i = 0; i < this.pipes.length; i++) {
            const pipe = this.pipes[i];
            pipe.update();

            if (pipe.x + pipe.width < 0) {
              this.pipes.splice(i, 1);
              i--;
              this.score++;
              this.updateScoreDisplay();
              playSound(scoreSound);
            }

            if (
              !pipe.collected &&
              this.bird.x + this.bird.size / 2 > pipe.x &&
              this.bird.x - this.bird.size / 2 < pipe.x + pipe.width &&
              this.bird.y > pipe.topPipeHeight &&
              this.bird.y < pipe.bottomPipeY
            ) {
              if (this.wordLettersNeeded.length > 0 && pipe.letter === this.wordLettersNeeded[0]) {
                collectedWordLetters.push(pipe.letter);
                this.wordLettersNeeded.shift();
                this.updateCollectedLettersDisplay();
                playSound(letterSound);
                if (this.wordLettersNeeded.length === 0) {
                  currentWordIndex++;
                  if (currentWordIndex < wordsToCollect.length) {
                    currentWord = wordsToCollect[currentWordIndex];
                    game.resetGame();
                  } else {
                    currentWord = "YOU WIN!";
                    this.gameOver = true;
                  }
                }
              } else if (!wordsToCollect[currentWordIndex]) {
                this.gameOver = true;
              }
              pipe.collected = true;
            }

            if (
              this.bird.x + this.bird.size / 2 > pipe.x &&
              this.bird.x - this.bird.size / 2 < pipe.x + pipe.width &&
              (this.bird.y - this.bird.size / 2 < pipe.topPipeHeight ||
                this.bird.y + this.bird.size / 2 > pipe.bottomPipeY)
            ) {
              this.gameOver = true;
              playSound(collisionSound);
              if (this.score > this.highScore) {
                this.highScore = this.score;
                localStorage.setItem("highScore", this.highScore);
                this.updateHighScoreDisplay();
              }
            }
          }
        },

        updateGameArea() {
          this.drawBackground();
          this.drawPipes();
          this.bird.draw();
          this.updatePipes();
          this.bird.update();

          if (
            this.bird.y + this.bird.size / 2 > canvas.height - 100 ||
            this.bird.y - this.bird.size / 2 < 0
          ) {
            this.gameOver = true;
            playSound(collisionSound);
            if (this.score > this.highScore) {
              this.highScore = this.score;
              localStorage.setItem("highScore", this.highScore);
              this.updateHighScoreDisplay();
            }
          }
        },

        gameLoop() {
          if (!this.gameStarted) {
            drawStartScreen();
            return;
          }

          if (this.gameOver) {
            drawGameOverScreen();
            return;
          }

          this.updateGameArea();
          requestAnimationFrame(this.gameLoop.bind(this));
        },

        startGame() {
          this.gameStarted = true;
          hideOverlay();
          this.gameLoop();
        },

        jump() {
          if (!this.gameStarted) {
            this.startGame();
            return;
          }
          if (!this.gameOver) {
            this.bird.jump();
          } else {
            this.resetGame();
            this.startGame();
          }
        },
      };

      function showOverlay(text, buttonText, buttonAction) {
        overlay.innerHTML = `<div class="overlay-text">${text}</div>${
          buttonText ? `<div id="overlayButton" class="overlay-button">${buttonText}</div>` : ""
        }`;
        overlay.style.display = "flex";
        if (buttonText) {
          const overlayButton = document.getElementById("overlayButton");
          overlayButton.onclick = buttonAction;
        }
      }

      function hideOverlay() {
        overlay.style.display = "none";
        overlay.innerHTML = "";
      }

      function drawStartScreen() {
        game.drawBackground();
        game.drawPipes();
        game.bird.draw();
        showOverlay(
          "Tap or Space to Start<br>Flappy Bird Clone<br>Collect letters to form words!",
          "Start Game",
          game.startGame.bind(game)
        );
      }

      function drawGameOverScreen() {
        game.drawBackground();
        game.drawPipes();
        game.bird.draw();
        let gameOverText = `Game Over!<br>Your Score: ${game.score} üíÄ`;
        if (currentWord === "YOU WIN!") {
          gameOverText = `üéâ YOU WIN! üéâ<br>You collected all words!`;
        } else {
          gameOverText = `Game Over!<br>Your Score: ${game.score} üíÄ<br>Word was: ${currentWord}`;
        }
        const highScoreText =
          game.score > game.highScore ? `<br>üéâ New High Score! üéâ` : `<br>High Score: ${game.highScore}`;
        showOverlay(gameOverText + highScoreText, "Restart Game", game.resetGame.bind(game));
      }

      document.addEventListener("keydown", function (event) {
        if (event.code === "Space") {
          game.jump();
        }
      });

      canvas.addEventListener("mousedown", game.jump.bind(game));
      canvas.addEventListener("touchstart", game.jump.bind(game));

      function playSound(audio) {
        audio.currentTime = 0;
        audio.play();
      }

      game.resetGame();
      drawStartScreen();
    </script>
  </body>
</html>